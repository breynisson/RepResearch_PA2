<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Severe weather events on population health and economics.</title>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}

pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Severe weather events on population health and economics.</h1>

<h2>Synopsis</h2>

<h2>Data Processing</h2>

<p>The data is read and we use the str() to take a peek at the data:</p>

<pre><code class="r">data&lt;-read.csv(&quot;repdata-data-StormData.csv.bz2&quot;)
str(data)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    902297 obs. of  37 variables:
##  $ STATE__   : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ BGN_DATE  : Factor w/ 16335 levels &quot;1/1/1966 0:00:00&quot;,..: 6523 6523 4242 11116 2224 2224 2260 383 3980 3980 ...
##  $ BGN_TIME  : Factor w/ 3608 levels &quot;00:00:00 AM&quot;,..: 272 287 2705 1683 2584 3186 242 1683 3186 3186 ...
##  $ TIME_ZONE : Factor w/ 22 levels &quot;ADT&quot;,&quot;AKS&quot;,&quot;AST&quot;,..: 7 7 7 7 7 7 7 7 7 7 ...
##  $ COUNTY    : num  97 3 57 89 43 77 9 123 125 57 ...
##  $ COUNTYNAME: Factor w/ 29601 levels &quot;&quot;,&quot;5NM E OF MACKINAC BRIDGE TO PRESQUE ISLE LT MI&quot;,..: 13513 1873 4598 10592 4372 10094 1973 23873 24418 4598 ...
##  $ STATE     : Factor w/ 72 levels &quot;AK&quot;,&quot;AL&quot;,&quot;AM&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...
##  $ EVTYPE    : Factor w/ 985 levels &quot;   HIGH SURF ADVISORY&quot;,..: 834 834 834 834 834 834 834 834 834 834 ...
##  $ BGN_RANGE : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ BGN_AZI   : Factor w/ 35 levels &quot;&quot;,&quot;  N&quot;,&quot; NW&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ BGN_LOCATI: Factor w/ 54429 levels &quot;&quot;,&quot;- 1 N Albion&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ END_DATE  : Factor w/ 6663 levels &quot;&quot;,&quot;1/1/1993 0:00:00&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ END_TIME  : Factor w/ 3647 levels &quot;&quot;,&quot; 0900CST&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ COUNTY_END: num  0 0 0 0 0 0 0 0 0 0 ...
##  $ COUNTYENDN: logi  NA NA NA NA NA NA ...
##  $ END_RANGE : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ END_AZI   : Factor w/ 24 levels &quot;&quot;,&quot;E&quot;,&quot;ENE&quot;,&quot;ESE&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ END_LOCATI: Factor w/ 34506 levels &quot;&quot;,&quot;- .5 NNW&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ LENGTH    : num  14 2 0.1 0 0 1.5 1.5 0 3.3 2.3 ...
##  $ WIDTH     : num  100 150 123 100 150 177 33 33 100 100 ...
##  $ F         : int  3 2 2 2 2 2 2 1 3 3 ...
##  $ MAG       : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ FATALITIES: num  0 0 0 0 0 0 0 0 1 0 ...
##  $ INJURIES  : num  15 0 2 2 2 6 1 0 14 0 ...
##  $ PROPDMG   : num  25 2.5 25 2.5 2.5 2.5 2.5 2.5 25 25 ...
##  $ PROPDMGEXP: Factor w/ 19 levels &quot;&quot;,&quot;-&quot;,&quot;?&quot;,&quot;+&quot;,..: 17 17 17 17 17 17 17 17 17 17 ...
##  $ CROPDMG   : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ CROPDMGEXP: Factor w/ 9 levels &quot;&quot;,&quot;?&quot;,&quot;0&quot;,&quot;2&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ WFO       : Factor w/ 542 levels &quot;&quot;,&quot; CI&quot;,&quot;$AC&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ STATEOFFIC: Factor w/ 250 levels &quot;&quot;,&quot;ALABAMA, Central&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ ZONENAMES : Factor w/ 25112 levels &quot;&quot;,&quot;                                                                                                                               &quot;| __truncated__,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ LATITUDE  : num  3040 3042 3340 3458 3412 ...
##  $ LONGITUDE : num  8812 8755 8742 8626 8642 ...
##  $ LATITUDE_E: num  3051 0 0 0 0 ...
##  $ LONGITUDE_: num  8806 0 0 0 0 ...
##  $ REMARKS   : Factor w/ 436781 levels &quot;&quot;,&quot;-2 at Deer Park\n&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ REFNUM    : num  1 2 3 4 5 6 7 8 9 10 ...
</code></pre>

<p>We start off by converting the BGN_DATE column data to date-type. We also discard the time data in this column:</p>

<pre><code class="r">data$BGN_DATE&lt;-as.Date(as.character(data$BGN_DATE), &quot;%m/%d/%Y&quot;)
</code></pre>

<p>And check that the converstion is OK:</p>

<pre><code class="r">str(data$BGN_DATE)
</code></pre>

<pre><code>##  Date[1:902297], format: &quot;1950-04-18&quot; &quot;1950-04-18&quot; &quot;1951-02-20&quot; &quot;1951-06-08&quot; ...
</code></pre>

<h2>Analysis</h2>

<h3>Fatalities and Injuries. Summary statistics for the United States.</h3>

<p>We take a look at what timeframe we are investigating. </p>

<p>The first date is</p>

<pre><code class="r">min(data$BGN_DATE)
</code></pre>

<pre><code>## [1] &quot;1950-01-03&quot;
</code></pre>

<p>while the last date in the dataset is </p>

<pre><code class="r">max(data$BGN_DATE)
</code></pre>

<pre><code>## [1] &quot;2011-11-30&quot;
</code></pre>

<p>We want to find out what are the most harmful weather effects to the population in the United States over the whole timeframe in question. To this end, we will look at fatalities and injuries. We will investigate these seperatly. We order the dataset based on the fatalities and injuries.</p>

<pre><code class="r">library(plyr)
fatalities&lt;-count(data, vars = &quot;EVTYPE&quot;, wt_var = &quot;FATALITIES&quot;)
fatalities&lt;-fatalities[order(-fatalities$freq),]

injuries&lt;-count(data, vars = &quot;EVTYPE&quot;, wt_var = &quot;INJURIES&quot;)
injuries&lt;-injuries[order(-injuries$freq),]
</code></pre>

<p>And then reduce the data to the top 10 causes:</p>

<pre><code class="r">fatalities&lt;-fatalities[1:10,]
fatalities
</code></pre>

<pre><code>##             EVTYPE freq
## 834        TORNADO 5633
## 130 EXCESSIVE HEAT 1903
## 153    FLASH FLOOD  978
## 275           HEAT  937
## 464      LIGHTNING  816
## 856      TSTM WIND  504
## 170          FLOOD  470
## 585    RIP CURRENT  368
## 359      HIGH WIND  248
## 19       AVALANCHE  224
</code></pre>

<pre><code class="r">injuries&lt;-injuries[1:10,]
injuries
</code></pre>

<pre><code>##                EVTYPE  freq
## 834           TORNADO 91346
## 856         TSTM WIND  6957
## 170             FLOOD  6789
## 130    EXCESSIVE HEAT  6525
## 464         LIGHTNING  5230
## 275              HEAT  2100
## 427         ICE STORM  1975
## 153       FLASH FLOOD  1777
## 760 THUNDERSTORM WIND  1488
## 244              HAIL  1361
</code></pre>

<p>From the two tables, we see that in the time period from 1950-01-03 to 2011-11-30, Tornados are the most harmful weather events to public health.</p>

<h3>Fatalities and Injuries. State-by-state analysis.</h3>

<p>We would like to analyze the fatalities and injuries caused by weather in each state.</p>

<pre><code class="r">fatalities_by_state_tmp&lt;-data[order(data$STATE, -data$FATALITIES),]
injuries_by_state_tmp&lt;-data[order(data$STATE, -data$INJURIES),]
</code></pre>

<p>We trim the data to just the STATE, EVTYPE and FATALITIES or INJURIES variables.</p>

<pre><code class="r">fatalities_by_state&lt;-fatalities_by_state_tmp[,c(&quot;STATE&quot;, &quot;EVTYPE&quot;, &quot;FATALITIES&quot;)]
injuries_by_state&lt;-injuries_by_state_tmp[,c(&quot;STATE&quot;, &quot;EVTYPE&quot;, &quot;INJURIES&quot;)]
</code></pre>

<p>Then sum the datasets by state:</p>

<pre><code class="r">fatalities_by_state_s&lt;-ddply(fatalities_by_state, .(STATE, EVTYPE), 
                             summarize, FATALITIES=sum(FATALITIES))

total_fatalities_per_state&lt;-ddply(fatalities_by_state, .(STATE), 
                             summarize, FATALITIES=sum(FATALITIES))

injuries_by_state_s&lt;-ddply(injuries_by_state, .(STATE, EVTYPE), 
                             summarize, INJURIES=sum(INJURIES))

total_injuries_per_state&lt;-ddply(injuries_by_state, .(STATE), 
                             summarize, INJURIES=sum(INJURIES))
</code></pre>

<p>And sort by decsending number of fatalities/injuries per state:</p>

<pre><code class="r">fatalities_by_state_r&lt;-arrange(fatalities_by_state_s, 
                               fatalities_by_state_s$STATE,
                               -fatalities_by_state_s$FATALITIES)
injuries_by_state_r&lt;-arrange(injuries_by_state_s, 
                               injuries_by_state_s$STATE,
                               -injuries_by_state_s$INJURIES)
</code></pre>

<p>We then reduce the data to the top fatalities/injury causes in each state:</p>

<pre><code class="r">top_fatalities_per_state&lt;-ddply(fatalities_by_state_r, .(STATE), 
                                function(x)x[1,])
top_injuries_per_state&lt;-ddply(injuries_by_state_r, .(STATE), 
                              function(x)x[1,])
</code></pre>

<p><strong>Top causes of Fatalities per State:</strong></p>

<pre><code class="r">top_fatalities_per_state
</code></pre>

<pre><code>##    STATE                   EVTYPE FATALITIES
## 1     AK                AVALANCHE         33
## 2     AL                  TORNADO        617
## 3     AM MARINE THUNDERSTORM WIND          6
## 4     AN         MARINE TSTM WIND          6
## 5     AR                  TORNADO        379
## 6     AS                  TSUNAMI         32
## 7     AZ              FLASH FLOOD         62
## 8     CA           EXCESSIVE HEAT        110
## 9     CO                AVALANCHE         48
## 10    CT                HIGH WIND          6
## 11    DC           EXCESSIVE HEAT         20
## 12    DE           EXCESSIVE HEAT          7
## 13    FL              RIP CURRENT        172
## 14    GA                  TORNADO        180
## 15    GM MARINE THUNDERSTORM WIND          1
## 16    GU              RIP CURRENT         20
## 17    HI                HIGH SURF         21
## 18    IA                  TORNADO         81
## 19    ID                AVALANCHE         16
## 20    IL                     HEAT        653
## 21    IN                  TORNADO        252
## 22    KS                  TORNADO        236
## 23    KY                  TORNADO        125
## 24    LA                  TORNADO        153
## 25    LC              MARINE HAIL          0
## 26    LE              MARINE HAIL          0
## 27    LH              MARINE HAIL          0
## 28    LM       MARINE STRONG WIND          2
## 29    LO              MARINE HAIL          0
## 30    LS       MARINE STRONG WIND          1
## 31    MA                  TORNADO        108
## 32    MD           EXCESSIVE HEAT         88
## 33    ME                LIGHTNING          6
## 34    MH                HIGH SURF          0
## 35    MI                  TORNADO        243
## 36    MN                  TORNADO         99
## 37    MO                  TORNADO        388
## 38    MS                  TORNADO        450
## 39    MT                LIGHTNING          9
## 40    NC                  TORNADO        126
## 41    ND                  TORNADO         25
## 42    NE                  TORNADO         54
## 43    NH                TSTM WIND          6
## 44    NJ           EXCESSIVE HEAT         39
## 45    NM              FLASH FLOOD         16
## 46    NV                     HEAT         54
## 47    NY           EXCESSIVE HEAT         93
## 48    OH                  TORNADO        191
## 49    OK                  TORNADO        296
## 50    OR                HIGH WIND         19
## 51    PA           EXCESSIVE HEAT        359
## 52    PH       MARINE STRONG WIND          1
## 53    PK         MARINE HIGH WIND          0
## 54    PM               WATERSPOUT          0
## 55    PR              FLASH FLOOD         34
## 56    PZ       MARINE STRONG WIND          5
## 57    RI                     HEAT          2
## 58    SC                  TORNADO         59
## 59    SD                  TORNADO         18
## 60    SL              MARINE HAIL          0
## 61    ST             STRONG WINDS          0
## 62    TN                  TORNADO        368
## 63    TX                  TORNADO        538
## 64    UT                AVALANCHE         44
## 65    VA                  TORNADO         36
## 66    VI                HIGH SURF          3
## 67    VT                    FLOOD          4
## 68    WA                AVALANCHE         35
## 69    WI                  TORNADO         96
## 70    WV              FLASH FLOOD         24
## 71    WY                AVALANCHE         23
## 72    XX MARINE THUNDERSTORM WIND          0
</code></pre>

<p><strong>Top causes of Injuries per State:</strong></p>

<pre><code class="r">top_injuries_per_state
</code></pre>

<pre><code>##    STATE                   EVTYPE INJURIES
## 1     AK                ICE STORM       34
## 2     AL                  TORNADO     7929
## 3     AM MARINE THUNDERSTORM WIND       22
## 4     AN       MARINE STRONG WIND       18
## 5     AR                  TORNADO     5116
## 6     AS                  TSUNAMI      129
## 7     AZ               DUST STORM      179
## 8     CA                 WILDFIRE      623
## 9     CO                  TORNADO      261
## 10    CT                  TORNADO      703
## 11    DC           EXCESSIVE HEAT      316
## 12    DE                  TORNADO       73
## 13    FL                  TORNADO     3340
## 14    GA                  TORNADO     3926
## 15    GM              MARINE HAIL        0
## 16    GU        HURRICANE/TYPHOON      333
## 17    HI              STRONG WIND       20
## 18    IA                  TORNADO     2208
## 19    ID        THUNDERSTORM WIND       74
## 20    IL                  TORNADO     4145
## 21    IN                  TORNADO     4224
## 22    KS                  TORNADO     2721
## 23    KY                  TORNADO     2806
## 24    LA                  TORNADO     2637
## 25    LC              MARINE HAIL        0
## 26    LE              MARINE HAIL        0
## 27    LH              MARINE HAIL        0
## 28    LM       MARINE STRONG WIND        1
## 29    LO              MARINE HAIL        0
## 30    LS              MARINE HAIL        0
## 31    MA                  TORNADO     1758
## 32    MD           EXCESSIVE HEAT      461
## 33    ME                LIGHTNING       70
## 34    MH                HIGH SURF        1
## 35    MI                  TORNADO     3362
## 36    MN                  TORNADO     1976
## 37    MO                  TORNADO     4330
## 38    MS                  TORNADO     6244
## 39    MT         WILD/FOREST FIRE       33
## 40    NC                  TORNADO     2536
## 41    ND                  TORNADO      326
## 42    NE                  TORNADO     1158
## 43    NH                LIGHTNING       85
## 44    NJ           EXCESSIVE HEAT      300
## 45    NM                  TORNADO      155
## 46    NV                    FLOOD       50
## 47    NY                  TORNADO      315
## 48    OH                  TORNADO     4438
## 49    OK                  TORNADO     4829
## 50    OR                HIGH WIND       50
## 51    PA                  TORNADO     1241
## 52    PH       MARINE STRONG WIND        0
## 53    PK         MARINE HIGH WIND        0
## 54    PM               WATERSPOUT        0
## 55    PR               HEAVY RAIN       10
## 56    PZ       MARINE STRONG WIND        3
## 57    RI                  TORNADO       23
## 58    SC                  TORNADO     1314
## 59    SD                  TORNADO      452
## 60    SL              MARINE HAIL        0
## 61    ST             STRONG WINDS        0
## 62    TN                  TORNADO     4748
## 63    TX                  TORNADO     8207
## 64    UT             WINTER STORM      415
## 65    VA                  TORNADO      914
## 66    VI                LIGHTNING        1
## 67    VT                TSTM WIND       24
## 68    WA                  TORNADO      303
## 69    WI                  TORNADO     1601
## 70    WV                TSTM WIND      142
## 71    WY             WINTER STORM      119
## 72    XX MARINE THUNDERSTORM WIND        0
</code></pre>

<p>Let&#39;s make preperations to display the Fatalities per State and Injuries per State:</p>

<pre><code class="r">library(ggplot2)
library(maps)
library(datasets)
library(gridExtra)

all_states&lt;-map_data(&quot;state&quot;)
state_names&lt;-data.frame(STATE=state.abb, region=tolower(state.name))

tmp_fat&lt;-merge(total_fatalities_per_state, state_names)
map_data_fat&lt;-merge(tmp_fat, all_states, by=&#39;region&#39;)

fp&lt;-ggplot(map_data_fat, aes(map_id = region)) +
  geom_map(aes(fill = FATALITIES), map = all_states, color =&quot;black&quot;) +
  expand_limits(x = all_states$long, y = all_states$lat) +
  theme(legend.position = &quot;bottom&quot;,
        axis.ticks = element_blank(), 
        axis.title = element_blank(), 
        axis.text =  element_blank()) +
  scale_fill_gradient(low=&quot;white&quot;, high=&quot;red&quot;) +
  guides(fill = guide_colorbar(barwidth = 10, barheight = .5)) + 
  ggtitle(&quot;&quot;)

tmp_inj&lt;-merge(total_injuries_per_state, state_names)
map_data_inj&lt;-merge(tmp_inj, all_states, by=&#39;region&#39;)

ip&lt;-ggplot(map_data_inj, aes(map_id = region)) +
  geom_map(aes(fill = INJURIES), map = all_states, color =&quot;black&quot;) +
  expand_limits(x = all_states$long, y = all_states$lat) +
  theme(legend.position = &quot;bottom&quot;,
        axis.ticks = element_blank(), 
        axis.title = element_blank(), 
        axis.text =  element_blank()) +
  scale_fill_gradient(low=&quot;white&quot;, high=&quot;red&quot;) +
  guides(fill = guide_colorbar(barwidth = 10, barheight = .5)) + 
  ggtitle(&quot;&quot;)
</code></pre>

<pre><code class="r">grid.arrange(arrangeGrob(fp, ip, ncol=2, main=&quot;Fatalities and Injuries per State&quot;))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk popHealthPerState"/> </p>

<h3>Property and Crop Damage. Summary statistics for the United States.</h3>

<p>The dataset contains two columns for property damage; PROPDMG and PROPDMGEXP. In the same manner, there are two columns for crop damage; CROPDMG and CROPDMGEXP. </p>

<p>We will make two new variables, which will hold the calculated property damage for each row. That is PROPERTYDAMAGEVALUE = PROPDMG * PROPDMGEXP and CROPDAMAGEVALUE = CROPDMG * CROPDMGEXP. </p>

<p>Let&#39;s look at the data for PROPDMGEXP:</p>

<pre><code class="r">table(data$PROPDMGEXP)
</code></pre>

<pre><code>## 
##             -      ?      +      0      1      2      3      4      5 
## 465934      1      8      5    216     25     13      4      4     28 
##      6      7      8      B      h      H      K      m      M 
##      4      5      1     40      1      6 424665      7  11330
</code></pre>

<p>We do see that there are a few different values here, and it is not clear how to handle many of those. The course of action taken here, is that we take K for Thousands, M for Millions and B for Billions. Any other value will be substituted with a value of &ldquo;1&rdquo;.  The same approach is taken for the CROPDMEXP values.</p>

<p>We start by setting the PROPDMGEXP AND CROPDMGEXP columns to lowercase. Then, new variables are made: PROPERTYDMGEXPNUMBER and CROPDMGEXPNUMBER.</p>

<pre><code class="r">data$PROPDMGEXP&lt;-tolower(data$PROPDMGEXP)
data$PROPERTYDMGEXPNUMBER&lt;-1
data$PROPERTYDMGEXPNUMBER[data$PROPDMGEXP==&quot;k&quot;]&lt;-1000
data$PROPERTYDMGEXPNUMBER[data$PROPDMGEXP==&quot;m&quot;]&lt;-1000000
data$PROPERTYDMGEXPNUMBER[data$PROPDMGEXP==&quot;b&quot;]&lt;-1000000000

data$CROPDMGEXP&lt;-tolower(data$CROPDMGEXP)
data$CROPDMGEXPNUMBER&lt;-1
data$CROPDMGEXPNUMBER[data$CROPDMGEXP==&quot;k&quot;]&lt;-1000
data$CROPDMGEXPNUMBER[data$CROPDMGEXP==&quot;m&quot;]&lt;-1000000
data$CROPDMGEXPNUMBER[data$CROPDMGEXP==&quot;b&quot;]&lt;-1000000000
</code></pre>

<p>We then find the numeric value for property and cropdamages:</p>

<pre><code class="r">data$PROPERTYDAMAGEVALUE&lt;-data$PROPDMG * data$PROPERTYDMGEXPNUMBER
data$CROPDAMAGEVALUE&lt;-data$CROPDMG * data$CROPDMGEXPNUMBER
</code></pre>

<p>We can now calculate the total economic damage (property and crop) within the timeframe:</p>

<pre><code class="r">library(scales)
totalPropertyDamage&lt;-sum(data$PROPERTYDAMAGEVALUE) + sum(data$CROPDAMAGEVALUE)
dollar(totalPropertyDamage)
</code></pre>

<pre><code>## [1] &quot;$476,422,842,480&quot;
</code></pre>

<h3>Property and Crop Damage. State-by-state analysis.</h3>

<p>We would like to analyze the property damage and crop damage caused by weather in each state.</p>

<pre><code class="r">propdmg_by_state_tmp&lt;-data[order(data$STATE, -data$PROPERTYDAMAGEVALUE),]
cropdmg_by_state_tmp&lt;-data[order(data$STATE, -data$CROPDAMAGEVALUE),]
</code></pre>

<p>We trim the data to just the STATE, EVTYPE and PROPERTYDAMAGEVALUE or CROPDAMAGEVALUE variables.</p>

<pre><code class="r">propdmg_by_state&lt;-propdmg_by_state_tmp[,c(&quot;STATE&quot;, &quot;EVTYPE&quot;, &quot;PROPERTYDAMAGEVALUE&quot;)]
cropdmg_by_state&lt;-cropdmg_by_state_tmp[,c(&quot;STATE&quot;, &quot;EVTYPE&quot;, &quot;CROPDAMAGEVALUE&quot;)]
</code></pre>

<p>Then sum the datasets by state:</p>

<pre><code class="r">propdmg_by_state_s&lt;-ddply(propdmg_by_state, .(STATE, EVTYPE), 
                          summarize, 
                          PROPERTYDAMAGEVALUE=sum(PROPERTYDAMAGEVALUE))

propdmg_by_state_per_state&lt;-ddply(propdmg_by_state, .(STATE), 
                                  summarize, 
                                  PROPERTYDAMAGEVALUE=sum(PROPERTYDAMAGEVALUE))

cropdmg_by_state_s&lt;-ddply(cropdmg_by_state, .(STATE, EVTYPE),
                          summarize, 
                          CROPDAMAGEVALUE=sum(CROPDAMAGEVALUE))

cropdmg_by_state_per_state&lt;-ddply(cropdmg_by_state, .(STATE), 
                             summarize, 
                             CROPDAMAGEVALUE=sum(CROPDAMAGEVALUE))
</code></pre>

<p>And sort by decsending number of property/crop damage per state:</p>

<pre><code class="r">propdmg_by_state_r&lt;-arrange(propdmg_by_state_s, 
                               propdmg_by_state_s$STATE,
                               -propdmg_by_state_s$PROPERTYDAMAGEVALUE)
cropdmg_by_state_r&lt;-arrange(cropdmg_by_state_s, 
                               cropdmg_by_state_s$STATE,
                               -cropdmg_by_state_s$CROPDAMAGEVALUE)
</code></pre>

<p>We reduce the data to the top property/crop damage causes in each state:</p>

<pre><code class="r">top_propdmg_per_state&lt;-ddply(propdmg_by_state_r, .(STATE), 
                                function(x)x[1,])
top_cropdmg_per_state&lt;-ddply(cropdmg_by_state_r, .(STATE), 
                              function(x)x[1,])
</code></pre>

<p><strong>Top causes of Property damage per State:</strong></p>

<pre><code class="r">top_propdmg_per_state$PROPERTYDAMAGEVALUE&lt;-dollar(top_propdmg_per_state$PROPERTYDAMAGEVALUE)
top_propdmg_per_state
</code></pre>

<pre><code>##    STATE                   EVTYPE PROPERTYDAMAGEVALUE
## 1     AK                    FLOOD        $157,131,940
## 2     AL                  TORNADO      $6,321,296,560
## 3     AM               WATERSPOUT          $5,102,000
## 4     AN MARINE THUNDERSTORM WIND            $169,000
## 5     AR                  TORNADO      $2,590,007,310
## 6     AS                  TSUNAMI         $81,000,000
## 7     AZ                     HAIL      $2,828,908,700
## 8     CA                    FLOOD    $116,751,420,000
## 9     CO                     HAIL      $1,423,944,785
## 10    CT                  TORNADO        $596,236,620
## 11    DC           TROPICAL STORM        $127,600,000
## 12    DE            COASTAL FLOOD         $40,150,000
## 13    FL        HURRICANE/TYPHOON     $27,596,865,000
## 14    GA                  TORNADO      $3,261,026,670
## 15    GM         MARINE TSTM WIND          $3,226,000
## 16    GU                  TYPHOON        $600,230,000
## 17    HI              FLASH FLOOD        $156,508,000
## 18    IA                  TORNADO      $2,286,576,200
## 19    ID                    FLOOD        $114,192,000
## 20    IL              RIVER FLOOD      $5,021,900,000
## 21    IN                  TORNADO      $2,594,793,890
## 22    KS                  TORNADO      $2,669,890,670
## 23    KY                  TORNADO        $888,768,680
## 24    LA              STORM SURGE     $31,742,735,000
## 25    LC              MARINE HAIL                  $0
## 26    LE MARINE THUNDERSTORM WIND             $25,000
## 27    LH              MARINE HAIL                  $0
## 28    LM         MARINE TSTM WIND          $1,205,000
## 29    LO         MARINE TSTM WIND             $50,000
## 30    LS         MARINE TSTM WIND            $400,000
## 31    MA                  TORNADO        $756,039,145
## 32    MD           TROPICAL STORM        $538,505,000
## 33    ME                ICE STORM        $318,230,000
## 34    MH                HIGH SURF          $5,000,000
## 35    MI                  TORNADO      $1,071,765,550
## 36    MN                  TORNADO      $1,903,701,140
## 37    MO                  TORNADO      $4,800,631,725
## 38    MS        HURRICANE/TYPHOON     $13,492,735,000
## 39    MT                     HAIL         $94,729,700
## 40    NC                HURRICANE      $4,979,861,000
## 41    ND                    FLOOD      $3,916,842,000
## 42    NE                  TORNADO      $1,718,164,710
## 43    NH                ICE STORM         $64,934,000
## 44    NJ                    FLOOD      $2,111,650,000
## 45    NM         WILD/FOREST FIRE      $1,509,700,000
## 46    NV                    FLOOD        $677,945,000
## 47    NY              FLASH FLOOD      $1,831,088,500
## 48    OH                  TORNADO      $2,279,857,790
## 49    OK                  TORNADO      $3,268,708,233
## 50    OR                    FLOOD        $722,172,500
## 51    PA                  TORNADO      $1,789,038,400
## 52    PH       MARINE STRONG WIND                  $0
## 53    PK         MARINE HIGH WIND             $31,000
## 54    PM               WATERSPOUT                  $0
## 55    PR                HURRICANE      $1,824,431,000
## 56    PZ       MARINE STRONG WIND             $76,000
## 57    RI                    FLOOD         $92,860,000
## 58    SC                  TORNADO        $531,505,190
## 59    SD                  TORNADO        $231,213,780
## 60    SL         MARINE TSTM WIND             $15,000
## 61    ST             STRONG WINDS                  $0
## 62    TN                    FLOOD      $4,245,346,300
## 63    TX           TROPICAL STORM      $5,491,193,000
## 64    UT                    FLOOD        $331,761,500
## 65    VA        HURRICANE/TYPHOON        $512,000,000
## 66    VI                HURRICANE         $28,220,000
## 67    VT                    FLOOD      $1,100,484,000
## 68    WA                    FLOOD        $212,683,000
## 69    WI                     HAIL        $961,723,350
## 70    WV              FLASH FLOOD        $485,226,100
## 71    WY                     HAIL        $111,221,705
## 72    XX MARINE THUNDERSTORM WIND                  $0
</code></pre>

<p><strong>Top causes of Crop damage per State:</strong></p>

<pre><code class="r">top_cropdmg_per_state$CROPDAMAGEVALUE&lt;-dollar(top_cropdmg_per_state$CROPDAMAGEVALUE)
top_cropdmg_per_state
</code></pre>

<pre><code>##    STATE                   EVTYPE CROPDAMAGEVALUE
## 1     AK                HIGH WIND        $157,000
## 2     AL                     HEAT    $400,100,000
## 3     AM MARINE THUNDERSTORM WIND         $50,000
## 4     AN              MARINE HAIL              $0
## 5     AR                    FLOOD    $141,065,000
## 6     AS              FLASH FLOOD      $1,267,000
## 7     AZ           TROPICAL STORM    $200,000,000
## 8     CA             EXTREME COLD    $731,160,000
## 9     CO                     HAIL    $116,490,000
## 10    CT                     HAIL         $30,000
## 11    DC                  DROUGHT          $5,000
## 12    DE                  DROUGHT     $29,100,000
## 13    FL        HURRICANE/TYPHOON    $955,200,000
## 14    GA                  DROUGHT    $717,285,000
## 15    GM              MARINE HAIL              $0
## 16    GU                HURRICANE    $100,480,000
## 17    HI                HIGH WIND      $2,600,000
## 18    IA                  DROUGHT  $2,009,630,000
## 19    ID           TSTM WIND/HAIL      $6,002,000
## 20    IL              RIVER FLOOD  $5,012,500,000
## 21    IN                    FLOOD    $698,198,000
## 22    KS                     HAIL    $259,405,300
## 23    KY                  DROUGHT    $226,000,000
## 24    LA                  DROUGHT    $587,430,000
## 25    LC              MARINE HAIL              $0
## 26    LE              MARINE HAIL              $0
## 27    LH              MARINE HAIL              $0
## 28    LM              MARINE HAIL              $0
## 29    LO              MARINE HAIL              $0
## 30    LS              MARINE HAIL              $0
## 31    MA        THUNDERSTORM WIND      $1,250,000
## 32    MD                  DROUGHT     $99,720,000
## 33    ME              HEAVY RAINS        $500,000
## 34    MH                HIGH SURF              $0
## 35    MI                  DROUGHT    $150,000,000
## 36    MN                     HAIL    $140,700,800
## 37    MO                    FLOOD    $593,040,000
## 38    MS                ICE STORM  $5,000,060,000
## 39    MT                     HAIL     $34,345,000
## 40    NC                HURRICANE  $1,425,130,000
## 41    ND                     HAIL    $189,355,003
## 42    NE                     HAIL    $737,993,650
## 43    NH                    FLOOD        $200,000
## 44    NJ                  DROUGHT     $80,000,000
## 45    NM                  DROUGHT     $14,400,000
## 46    NV                    FLOOD      $6,000,000
## 47    NY                  DROUGHT    $100,200,000
## 48    OH                  DROUGHT    $200,000,000
## 49    OK                  DROUGHT  $1,097,040,000
## 50    OR                     HAIL     $36,028,000
## 51    PA                  DROUGHT    $539,400,000
## 52    PH       MARINE STRONG WIND              $0
## 53    PK         MARINE HIGH WIND              $0
## 54    PM               WATERSPOUT              $0
## 55    PR                HURRICANE    $451,000,000
## 56    PZ         MARINE HIGH WIND              $0
## 57    RI                 BLIZZARD              $0
## 58    SC                HURRICANE     $20,300,000
## 59    SD                     HAIL     $64,274,050
## 60    SL              MARINE HAIL              $0
## 61    ST             STRONG WINDS              $0
## 62    TN                TSTM WIND      $9,146,500
## 63    TX                  DROUGHT  $6,373,438,000
## 64    UT                HIGH WIND      $1,110,000
## 65    VA                  DROUGHT    $297,480,000
## 66    VI                  DROUGHT        $200,000
## 67    VT              FLASH FLOOD     $14,725,000
## 68    WA                     HAIL    $209,501,000
## 69    WI                    FLOOD    $466,888,500
## 70    WV                  DROUGHT     $19,746,000
## 71    WY                     HAIL      $1,881,200
## 72    XX MARINE THUNDERSTORM WIND              $0
</code></pre>

<p>We then visualize the property damage and crop damage per state:</p>

<pre><code class="r">tmp_propdmg&lt;-merge(top_propdmg_per_state, state_names)
map_data_propdmg&lt;-merge(tmp_propdmg, all_states, by=&#39;region&#39;)

pr&lt;-ggplot(map_data_propdmg, aes(map_id = region)) +
  geom_map(aes(fill = PROPERTYDAMAGEVALUE), map = all_states, color =&quot;black&quot;) +
  expand_limits(x = all_states$long, y = all_states$lat) +
  theme(legend.position = &quot;bottom&quot;,
        axis.ticks = element_blank(), 
        axis.title = element_blank(), 
        axis.text =  element_blank()) +
  scale_fill_gradient(low=&quot;white&quot;, high=&quot;red&quot;) +
  guides(fill = guide_colorbar(barwidth = 10, barheight = .5)) + 
  ggtitle(&quot;&quot;)

tmp_cropdmg&lt;-merge(top_cropdmg_per_state, state_names)
map_data_cropdmg&lt;-merge(tmp_cropdmg, all_states, by=&#39;region&#39;)

cr&lt;-ggplot(map_data_cropdmg, aes(map_id = region)) +
  geom_map(aes(fill = CROPDAMAGEVALUE), map = all_states, color =&quot;black&quot;) +
  expand_limits(x = all_states$long, y = all_states$lat) +
  theme(legend.position = &quot;bottom&quot;,
        axis.ticks = element_blank(), 
        axis.title = element_blank(), 
        axis.text =  element_blank()) +
  scale_fill_gradient(low=&quot;white&quot;, high=&quot;red&quot;) +
  guides(fill = guide_colorbar(barwidth = 10, barheight = .5)) + 
  ggtitle(&quot;&quot;)
</code></pre>

<pre><code class="r">grid.arrange(arrangeGrob(pr, cr, ncol=2, main=&quot;Property and Crop Damage per State&quot;))
</code></pre>

<pre><code>## Error: Discrete value supplied to continuous scale
</code></pre>

<h2>Results</h2>

</body>

</html>
